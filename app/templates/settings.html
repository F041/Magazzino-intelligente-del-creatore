{% extends "base.html" %} {% block title %}Impostazioni - Magazzino del
Creatore{% endblock %} {% block head_styles %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/settings.css') }}"
/>
{% endblock %} {% block content %}
<h1>Impostazioni</h1>
<p>
  Configura il comportamento del tuo Magazzino. Le impostazioni qui
  sovrascrivono i valori prestabiliti.
</p>

{% with messages = get_flashed_messages(with_categories=true) %} {% if messages
%} {% for category, message in messages %}
<div
  class="{{ 'success-message' if category == 'success' else 'error-message' }}"
>
  <i
    class="fas {{ 'fa-check-circle' if category == 'success' else 'fa-exclamation-triangle' }}"
    style="margin-right: 10px"
  ></i>
  <span>{{ message }}</span>
</div>
{% endfor %} {% endif %} {% endwith %}

<div class="tabs-container">
  <nav class="tabs-navigation">
    <div class="tab-link" data-tab="generali">
      <i class="fas fa-brain"></i>
      <span>Intelligenza artificiale</span>
    </div>
    <div class="tab-link" data-tab="sito-web">
      <i class="fas fa-globe-europe"></i>
      <span>Dati sito web</span>
    </div>
    <div class="tab-link" data-tab="protezione">
      <i class="fas fa-hdd"></i>
      <span>Backup e ripristino</span>
    </div>
  </nav>

  <form
    method="POST"
    action="{{ url_for('settings.settings_page') }}"
    class="settings-form"
    autocomplete="off"
    id="settings-main-form"
  >
    {% include '_settings_generali_tab.html' %}

    <div id="sito-web" class="tab-content">
      <div class="form-section">
        <h2>Connettore dati per WordPress</h2>
        <p>
          Inserisci qui le informazioni del tuo sito WordPress per permettere al
          Magazzino di indicizzare automaticamente tutti i tuoi articoli e
          pagine.
        </p>
        <div class="form-group">
          <div class="label-wrapper">
            <label for="wordpress_url">URL del sito wordPress</label>
            <span class="info-tooltip">
              <span class="fa-stack"
                ><i class="fas fa-circle fa-stack-2x"></i
                ><i class="fas fa-info fa-stack-1x fa-inverse"></i
              ></span>
              <span class="tooltip-text"
                >Inserisci l'indirizzo completo della home page. Esempio:
                https://www.ilmiosito.com</span
              >
            </span>
          </div>
          <input
            type="url"
            id="wordpress_url"
            name="wordpress_url"
            value="{{ settings.get('wordpress_url', '') }}"
            placeholder="https://www.esempio.com"
          />
        </div>

        <div class="form-group">
          <div class="label-wrapper">
            <label for="wordpress_username">Nome utente WordPress</label>
            <span class="info-tooltip">
              <span class="fa-stack"
                ><i class="fas fa-circle fa-stack-2x"></i
                ><i class="fas fa-info fa-stack-1x fa-inverse"></i
              ></span>
              <span class="tooltip-text"
                >Inserisci il nome utente esatto dell'amministratore a cui hai
                associato la password applicazione.</span
              >
            </span>
          </div>
          <input
            type="text"
            id="wordpress_username"
            name="wordpress_username"
            value="{{ settings.get('wordpress_username') or '' }}"
            placeholder="Es: admin"
          />
        </div>

        <div class="form-group">
          <div class="label-wrapper">
            <label for="wordpress_api_key"
              >Password applicazione WordPress</label
            >
            <div class="tooltip-group">
              <span class="info-tooltip">
                <span class="fa-stack"
                  ><i class="fas fa-circle fa-stack-2x"></i
                  ><i class="fas fa-info fa-stack-1x fa-inverse"></i
                ></span>
                <span class="tooltip-text"
                  >Genera una "Password delle applicazioni" dalla bacheca di
                  WordPress (Utenti > Profilo > scrolla in basso).</span
                >
              </span>
              <a
                href="https://wordpress.com/support/security/two-step-authentication/application-specific-passwords/"
                target="_blank"
                class="help-video-link"
                title="Guida ufficiale"
                ><i class="fab fa-wordpress"></i
              ></a>
            </div>
          </div>
          <input
            type="password"
            id="wordpress_api_key"
            name="wordpress_api_key"
            value="{{ settings.get('wordpress_api_key', '') }}"
            placeholder="xxxx xxxx xxxx xxxx xxxx xxxx"
            autocomplete="new-password"
          />
        </div>

        <div
          style="
            margin-top: 20px;
            border-top: 1px solid var(--color-border-light);
            padding-top: 20px;
          "
        >
          <button
            type="button"
            id="sync-wordpress-btn"
            class="action-btn success-btn"
          >
            <i class="fas fa-sync-alt fa-fw"></i>
            <span>Recupera TUTTI i contenuti</span>
          </button>
          <!-- loader inline aggiunto -->
          <span
            id="sync-loader"
            class="inline-spinner"
            style="display: none"
            aria-hidden="true"
            ><i class="fas fa-spinner fa-spin"></i
          ></span>
        </div>
        <div id="sync-message" style="margin-top: 15px"></div>
      </div>
    </div>

    {% include '_protezione_tab.html' %}

    <div class="form-actions">
      <button
        type="button"
        id="reset-ai-settings-btn"
        class="action-btn secondary"
        style="display: none"
      >
        <i class="fas fa-undo"></i> Ripristina predefinite
      </button>
      <button type="submit" class="action-btn">Salva impostazioni</button>
    </div>
  </form>
</div>
{% endblock %} {% block scripts %} 
{{ super() }}
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>
<script src="{{ url_for('static', filename='js/_settings_wordpress.js') }}"></script>
{% endblock %}
